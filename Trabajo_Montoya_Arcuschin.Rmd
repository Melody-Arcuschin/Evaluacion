---
title: "Trabajo_Montoya_Arcuschin"
author: "Melody Sol Arcuschin y Vitor Montoya"
date: "2024-06-17"
output: html_document
---

Librerías y lectura de documentos
```{r}
library(tidyverse)
library(haven)
library(openxlsx)
library(kableExtra)


setwd("C:/Users/melod/Escritorio/Estudio/Posgrado/2024/Mercado de trabajo/Evaluación/Evaluacion/")
bolivia<- readRDS("Bolivia_1a4T2019.RDS")
chile <- read.csv2("Chile_2019.csv")
```

Bolivia-Observación
```{r}
View(bolivia)
colnames(bolivia)
```

Bolivia-Indicadores
```{r}
suma_pea <- sum(bolivia$fact_mes[bolivia$pea == 1], na.rm = TRUE)
suma_desocupados <- sum(bolivia$fact_mes[bolivia$pead == 1], na.rm = TRUE)
suma_ocupados <- sum(bolivia$fact_mes[bolivia$peao == 1], na.rm = TRUE)
suma_total <- sum(bolivia$fact_mes)
informales <- sum(bolivia$fact_mes[bolivia$s2_26a <= 2], na.rm = TRUE) #se toma a los que tienen menos 
asalariados <- sum(bolivia$fact_mes[bolivia$s2_17a == 2], na.rm = TRUE)
asalariados_precarios <- sum(bolivia$fact_mes[(bolivia$s2_21 %in% c(2,3, 5)) | (bolivia$s2_21a != 3)], na.rm = TRUE)
TA_B = suma_pea/suma_total
TD_B = suma_desocupados/suma_pea
TI_B = informales/suma_ocupados
TP_B = asalariados_precarios/asalariados
```

Chile-Observación
```{r}
View(chile)
colnames(chile)
#Control de los datos comparando datos del marco poblacional del registro de la encuesta. Los resultados coinciden.
chile %>% count(grupo_edad, wt=fact_cal_esi) %>% mutate(porcentaje =round((n/sum(n)*100), digits = 1))
```



Como no existe ninguna variable que indique activo/inactivo/desocupado, se procede a recodificar la variable "cse_específico", que indica los distintos tipos de perfiles para ocupado, desocupado e inactivo, en una nueva variable "categoría" con los tres perfiles mencionados.

```{r}
chile$categoría <- chile$cse_especifico %>%
  as.character() %>%
  fct_recode(
    "Menor de 15" = "0",
    "Ocupado" = "1",
    "Ocupado" = "2",
    "Ocupado" = "3",
    "Ocupado" = "4",
    "Ocupado" = "5",
    "Ocupado" = "6",
    "Ocupado" = "7",
    "Descocupado" = "8",
    "Descocupado" = "9",
    "Inactivo" = "10",
    "Inactivo" = "11",
    "Inactivo" = "12",
    "Inactivo" = "13",
    "Inactivo" = "14",
    "Inactivo" = "15",
    "Inactivo" = "16",
    "Inactivo" = "17",
    "Inactivo" = "18",
    "Inactivo" = "19",
    "Inactivo" = "20",
    "Inactivo" = "21",
    "Inactivo" = "22",
    "Inactivo" = "23",
    "Inactivo" = "24",
    "Inactivo" = "25",
    "Inactivo" = "26",
    "Inactivo" = "27",
    "Inactivo" = "28")
```


Chile-Indicadores


```{r}
chile <- cse_específico %>% 

OcupadoChile<-chile %>% filter(categoría == "Ocupado") %>% pull(n)

DesocupadoChile<-chile %>% filter(categoría == "Desocupado") %>% pull(n)

PoblTotChile<-sum(chile$fact_cal_esi)

PeaChile<-chile %>% filter(categoría %in% c("Ocupado", "Desocupado")) %>% 
  summarise(pea=sum(fact_cal_esi))

TasaActivChile<-round((PeaChile/PoblTotChile*100), digits = 1)

TasaDesocupChile<-round((DesocupadoChile/PeaChile*100), digits = 1)

Datosgenerales<-tibble(Ocupados=OcupadoChile, Desocupados=DesocupadoChile, "Población total"=PoblTotChile,"Población Económicamente Activa"= PeaChile, "Tasa de Actividad"= TasaActivChile, "Tasa de desocupación"=TasaDesocupChile)

kable(t(Datosgenerales), caption = "Datos generales del mercado de trabajo chileno (2019)")

```



# Sector formal e informal

Uso la variable nº42 "cise" de clasificación internacional de categoría en el empleo. Se procede a recodificar las modalidades.
```{r}
## Recoding chile$cise into chile$`Categoría empleo (cise)`
chile$`Categoría empleo (cise)` <- chile$cise %>%
  as.character() %>%
  fct_recode(
    "No corrresponde" = "0",
    "Empleador" = "1",
    "Cuenta propia" = "2",
    "Asalariado sector privado" = "3",
    "Asalariado sector público" = "4",
    "Personal de servicio doméstico puertas afueras" = "5",
    "Personal de servicio doméstico puertas adentro" = "6",
    "Familiar/personal no remunerado" = "7"
  )


CategoríaEmpleoCiseChile<-chile %>% count(`Categoría empleo (cise)`, wt=fact_cal_esi) %>% mutate(n= round(n, digits = 0), Porcentaje =round((n/sum(n)*100), digits = 1))

kable(CategoríaEmpleoCiseChile, caption = "Población activa por categoría de empleo (cise, 2019)")

## Se verifica que "No corresponde" = Desocupao + Inactivo + Menor de 15.
```



Uso la variable nº75 "b15_1" que corresponde a la pregunta "En todo el país, ¿cuántas personas trabajan en esa empresa, negocio, institución que le paga o en esa actividad por cuenta propia, incluyendo a ...?"

```{r}
## Recoding chile$b15_1 into chile$`Tamaño empresa`
chile$`Tamaño empresa` <- chile$b15_1 %>%
  as.character() %>%
  fct_recode(
    "Menos de 5" = "1",
    "De 5 a 10" = "2",
    "Entre 11 y 49" = "3",
    "Entre 50 y 199" = "4",
    "200 y más personas" = "5"
  )

chile %>% count(`Tamaño empresa`, wt=fact_cal_esi) %>% mutate(n= round(n, digits = 0), Porcentaje =round((n/sum(n)*100), digits = 1))
```







